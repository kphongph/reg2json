<!--
@license
Copyright (c) 2015 The Polymer Project Authors. All rights reserved.
This code may only be used under the BSD style license found at http://polymer.github.io/LICENSE.txt
The complete set of authors may be found at http://polymer.github.io/AUTHORS.txt
The complete set of contributors may be found at http://polymer.github.io/CONTRIBUTORS.txt
Code distributed by Google as part of the polymer project is also
subject to an additional IP rights grant found at http://polymer.github.io/PATENTS.txt
-->
<link rel="import" href="../bower_components/polymer/polymer.html">
<link rel="import" href="../bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="../bower_components/paper-input/paper-input.html">
<link rel="import" href="../bower_components/paper-material/paper-material.html">
<link rel="import" href="../bower_components/paper-styles/paper-styles.html">
<link rel="import" href="../bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="../bower_components/paper-spinner/paper-spinner.html">

<!--
An element providing a solution to no problem in particular.

Example:

    <seed-element></seed-element>

@group Seed Elements
@element seed-element
@demo demo/index.html
@hero hero.svg
-->
<dom-module id="curriculum-report">
        
  <template>
    
    <style>
    :host {
      display: block;
      box-sizing: border-box;
    }
    
    .center {
      @apply(--layout-center);
    }
    
    .layout {
      @apply(--layout);
    }
    
    .center-layout{
      @apply(--layout-center);
      @apply(--layout);
    }
    .horizontal {
      @apply(--layout-horizontal);
    }
    .vertical {
      @apply(--layout-vertical);
    }
    .flex-4 {
      @apply(--layout-flex-4); 
    }
    .flex-7 {
      @apply(--layout-flex-8); 
    }
    
    .flex-1 {
      @apply(--layout-flex-1); 
    }
    
    .flex-2 {
      @apply(--layout-flex-2); 
    }
    
    .headerCurriculumNumber {
      @apply(--paper-font-caption);
      text-align:left;
      font-style:bold;
      color: #000;
      opacity: 0.54;
      height:56px;
      border-bottom-width:1px;
      border-bottom-style:solid;
      border-bottom-color: var(--divider-color);
      margin-left:24px;
    }
    
    .header {
      @apply(--paper-font-caption);
      text-align:right;
      color: #000;
      opacity: 0.54;
      height:56px;
      border-bottom-width:1px;
      border-bottom-style:solid;
      border-bottom-color: var(--divider-color);
      margin-right:24px;
    }
    
    .contentCurriculum {
      @apply(--paper-font-menu);
      text-align:left;
      color: #000;
      opacity: 0.87;
      height:48px;
      border-bottom-width:1px;
      border-bottom-style:solid;
      border-bottom-color: var(--divider-color);
      margin-left:24px;
    }
    
    .content {
      @apply(--paper-font-menu);
      text-align:right;
      color: #000;
      opacity: 0.87;
      height:48px;
      border-bottom-width:1px;
      border-bottom-style:solid;
      border-bottom-color: var(--divider-color);
      margin-right:24px;
    }
 
    .shadow {
       @apply(--shadow-elevation-2dp);
    }

  </style>
    
    <iron-ajax 
      id="getQuery"            
      handle-as="json"
      method="GET"
      content-type="application/json"
      on-response="_handleResponse"></iron-ajax>
          
    <paper-material>
        <div class="vertical shadow">
     
          <div class="horizontal header">
            <div class="flex-2 headerCurriculumNumber center-layout"><span>Code</span></div>
            <div class="flex-7 center-layout"><span>Name</span></div>
            <div class="horizontal flex-4 center-layout"><span>Owner</span></div>
          </div>
        </div>
   
       
        <template is="dom-repeat" items="{{json}}" as="json">
        
                <div class="horizontal content">
                 <div class="flex-2 contentCurriculum center-layout">{{json.number}}</div>
                 <div class="flex-7 center-layout">{{json.name.thai}}</div>
                  <div class="horizontal flex-7 center-layout">{{json.owner.department}}</div>
                </div>
        
        </template>
    </paper-material>
    <paper-spinner active="{{loading}}"></paper-spinner>
  </template>

<script>

  Polymer({
      is: 'curriculum-report',
      properties: {
        json: {
          type:Object,
          notify:true,
          observer: '_jsonChanged'
        },
        loading: {
          type: Boolean,
          value: false,
          notify: true
        }

      },
    
      ready: function() {   
        
        //alert("test");
        this.loading = true;
        this.$.getQuery.url = "/mongo/tqf/curriculum/";
        this.$.getQuery.generateRequest();
      },
      _jsonChanged: function(newVal) {
        console.log(newVal);
        if(newVal) {
          //this.set('number',newVal.number);
          //this.set('descriptionThai',newVal.description.thai);
          //this.set('descriptionEnglish',newVal.description.english);
        }
      },
    _handleResponse: function() {

      this.set('json',this.$.getQuery.lastResponse);
      this.loading = false;
      
    }    

  });

</script>
  
</dom-module>